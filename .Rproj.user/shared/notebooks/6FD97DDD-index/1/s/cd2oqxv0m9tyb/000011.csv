"0",""
"0",""
"0","get_by_trait_most_hated_bin <- function(movie_trait, all = FALSE){"
"0","  all_movies_with_ratings_df50K_hate_all <- all_movies_with_ratings_df50K_hate %>% "
"0","    group_by(Metascore_Score_Meaning, all_movies_with_ratings_df50K_hate[[movie_trait]]) %>% "
"0","    summarise(num_of_movies = n(), "
"0","              hated = sum(Most_hated_bin), "
"0","              not_hated = num_of_movies - hated, "
"0","              proportion_hated = mean(Most_hated_bin), "
"0","              median_hate = median(Percentage_1_numeric)) %>% mutate(movie_trait = movie_trait)"
"0","  colnames(all_movies_with_ratings_df50K_hate_all)[2] <- ""bin"""
"0","  all_movies_with_ratings_df50K_hate_all$rownames <- with(all_movies_with_ratings_df50K_hate_all, ifelse(bin == 0, paste0(""Non-"", movie_trait), movie_trait))"
"0","  all_movies_with_ratings_df50K_hate <- all_movies_with_ratings_df50K_hate_all %>% select(-c(not_hated, median_hate, rownames))"
"0","  if(all){"
"0","    all_movies_with_ratings_df50K_hate <- all_movies_with_ratings_df50K_hate_all"
"0","  }"
"0","  all_movies_with_ratings_df50K_hate"
"0","}"
"0","get_contingency_table <- function(movie_trait, grp){"
"0","  contingency_tbl <- get_by_trait_most_hated_bin(movie_trait, all = TRUE) %>% ungroup() %>% select(Metascore_Score_Meaning, rownames, movie_trait, hated, not_hated) %>% filter(Metascore_Score_Meaning == metascore_groups[grp]) %>% as.data.frame() "
"0","  rownames(contingency_tbl) <- contingency_tbl$rownames"
"0","  contingency_tbl"
"0","}"
"0",""
"0","all_movies_with_ratings_df50K_hate$Leads_male_male <- with(all_movies_with_ratings_df50K_hate, Lead1_male*Lead2_male)"
"0","all_movies_with_ratings_df50K_hate$Leads_female_female <- with(all_movies_with_ratings_df50K_hate, Lead1_female*Lead2_female)"
"0",""
"0","all_movies_with_ratings_df50K_hate$Auteur_bin <- as.numeric(all_movies_with_ratings_df50K_hate$Auteur_bin) - 1"
"0","all_movies_with_ratings_df50K_hate$Horror_bin <- as.numeric(all_movies_with_ratings_df50K_hate$Horror_bin) - 1"
"0","all_movies_with_ratings_df50K_hate$Comedy_bin <- as.numeric(all_movies_with_ratings_df50K_hate$Comedy_bin) - 1"
"0","all_movies_with_ratings_df50K_hate$Drama_bin <- as.numeric(all_movies_with_ratings_df50K_hate$Drama_bin) - 1"
"0","all_movies_with_ratings_df50K_hate$Action_bin <- as.numeric(all_movies_with_ratings_df50K_hate$Action_bin) - 1"
"0",""
"0",""
"0",""
"0","get_chisq_p_value <- function(most_hated_row_ls){"
"0","  # most_hated_row <- most_hated_wider_df[1,]"
"0","  movie_trait = most_hated_row_ls$movie_trait"
"0","  grp = most_hated_row_ls$metascore_group"
"0","  contingency_tbl <- get_contingency_table(movie_trait, grp)"
"0","  p_value <- chisq.test(contingency_tbl %>% select(hated, not_hated))$p.value"
"0","  most_hated_row_ls$p_value <- round(p_value, 3)"
"0","  most_hated_row_ls"
"0","}"
"0",""
"0",""
"0","most_hated_df <- get_by_trait_most_hated_bin(""Lead1_female"") %>%  "
"0","# ## Women-led"
"0","# bind_rows(,"
"0","          "
"0","## Two-men-led"
"0","bind_rows(get_by_trait_most_hated_bin(""Leads_male_male""),"
"0","          "
"0","          get_by_trait_most_hated_bin(""Leads_female_female""),"
"0",""
"0","## Horror"
"0","get_by_trait_most_hated_bin(""Horror_bin""),"
"0",""
"0","## Drama"
"0","get_by_trait_most_hated_bin(""Drama_bin""),"
"0",""
"0","## Comedy"
"0","get_by_trait_most_hated_bin(""Comedy_bin""),"
"0",""
"0","## Action"
"0","get_by_trait_most_hated_bin(""Action_bin""),"
"0",""
"0","## Franchise"
"0","get_by_trait_most_hated_bin(""Franchise_bin""),"
"0",""
"0","## Woman Writer"
"0","get_by_trait_most_hated_bin(""woman_writer_bin""),"
"0",""
"0","## Woman Director"
"0","get_by_trait_most_hated_bin(""woman_director_bin""),"
"0",""
"0","## Auteur"
"0","get_by_trait_most_hated_bin(""Auteur_bin"")"
"0",""
"0",")"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"0","# most_hated_wider_df"
"0",""
"0","most_hated_wider_df <- most_hated_df %>% pivot_wider(names_from = bin, values_from = c(num_of_movies, hated, proportion_hated))"
"0","most_hated_wider_df$metascore_group = with(most_hated_wider_df, ifelse(Metascore_Score_Meaning %>% str_detect(""Favorable""), 2, ifelse(Metascore_Score_Meaning %>% str_detect(""Mixed""), 1, 3)))"
"0",""
"0","most_hated_wider_ls <- split(most_hated_wider_df, seq(nrow(most_hated_wider_df)))"
"0","most_hated_wider_df <- most_hated_wider_ls %>% map_df(get_chisq_p_value) %>% select(-c(ends_with(""-1"")))"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","Warning: Chi-squared approximation may be incorrect"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","Warning: Chi-squared approximation may be incorrect"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","Warning: Chi-squared approximation may be incorrect"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","Warning: Chi-squared approximation may be incorrect"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","Warning: Chi-squared approximation may be incorrect"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
"0","get_chisq_p_value(most_hated_wider_df[1,])"
"2","`summarise()` has grouped output by 'Metascore_Score_Meaning'. You can override using the `.groups` argument."
