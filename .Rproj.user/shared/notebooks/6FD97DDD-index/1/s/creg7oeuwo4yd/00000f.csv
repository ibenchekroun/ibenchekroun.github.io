"0",""
"0","fig1 <- plot_ly(data= most_hated_wider_df %>% filter(Metascore_Score_Meaning == metascore_groups[2]), x = ~movie_trait_readable, y = ~proportion_hated_0_plot*100, type = 'bar', name = ""Doesn't have movie trait"", marker = list(color = ""#96ceb4""),"
"0","                 text = ~num_of_movies_0,"
"0","                # text2 = ~p_value ,"
"0","                textposition = ""none"","
"0","                hovertext = ~ paste0(""<br><b>Non-"", `movie_trait_readable`, ""</b><br>"", "
"0","                          ""Number of movies: "", num_of_movies_0, ""<br>"","
"0","                          ""<b>"", proportion_hated_0_plot*100, ""%</b> are among the 100 most hated <i>Favourable</i> films <br>"","
"0","                          'Chi-sq p-value:', p_value"
"0","),"
"0","hovertemplate = ""%{hovertext}<extra></extra>"")"
"0","# ,"
"0","#            hovertemplate = ""%{hovertext}<extra></extra>"")"
"0","#                 hovertemplate = paste("
"0","#                         '<br><b>Non-%{x}</b><br>',"
"0","#                        'Number of movies: %{text}',"
"0","#                 '<i>\n</i>%{y:.2f}% are among the 100 most hated Favourable films',"
"0","#                 'Chi-sq p-value:', ~p_value"
"0","#                 ))"
"0",""
"0","fig1 <- fig1 %>% add_trace(y = ~proportion_hated_1_plot*100, name = 'Has movie trait', marker = list(color = ""#86af49""),"
"0","                 text = ~num_of_movies_1,"
"0","                textposition = ""none"","
"0","                hovertext = ~ paste0(""<br><b>"", `movie_trait_readable`, ""</b><br>"", "
"0","                          ""Number of movies: "", num_of_movies_1, ""<br>"","
"0","                          ""<b>"", proportion_hated_1_plot*100, ""%</b> are among the 100 most hated <i>Favourable</i> films <br>"","
"0","                          'Chi-sq p-value:', p_value"
"0","),"
"0","hovertemplate = ""%{hovertext}<extra></extra>"")"
"0",""
"0","fig1 <- fig1 %>% layout("
"0","               title = ""Sales by Parts of Supermarket 2019 vs 2020"","
"0","               xaxis = list(title = ""Movie Trait?"", showticklabels = FALSE),"
"0","               yaxis = list(title = ' \n Favourable' #,"
"0","                            # showgrid = FALSE"
"0","                            , range=c(0,30),"
"0","                            tickfont = list(color = '#b2b2b2')), "
"0","               barmode = 'group',"
"0","               # plot_bgcolor='#deeaee',"
"0","              scene = list(aspectratio = list(x=1, y=1, z=1))# right margin: 10px"
"0","              # , legend = list(orientation = ""h"",   # show entries horizontally"
"0","              #        xanchor = ""center"",  # use center of legend as anchor"
"0","              #        x = 0.5)"
"0","              , legend = list(x = 0, y = 0.96, orientation = ""h"")"
"0","    ) "
"0",""
"0","fig2 <- plot_ly(data= most_hated_wider_df %>% filter(Metascore_Score_Meaning == metascore_groups[1]), x = ~movie_trait_readable, y = ~proportion_hated_0_plot*100, type = 'bar', name = 'No', marker = list(color = '#EEDC82'),"
"0","                 text = ~num_of_movies_0,"
"0","                textposition = ""none"","
"0","                hovertext = ~ paste0(""<br><b>Non-"", `movie_trait_readable`, ""</b><br>"", "
"0","                          ""Number of movies: "", num_of_movies_0, ""<br>"","
"0","                          ""<b>"", proportion_hated_0_plot*100, ""%</b> are among the 100 most hated <i>Mixed</i> films <br>"","
"0","                          'Chi-sq p-value:', p_value"
"0","),"
"0","hovertemplate = ""%{hovertext}<extra></extra>"")"
"0",""
"0","fig2 <- fig2 %>% add_trace(y = ~proportion_hated_1_plot*100, name = 'Yes', marker = list(color = '#DAA520'),"
"0","                 text = ~num_of_movies_1,"
"0","                textposition = ""none"","
"0","                hovertext = ~ paste0(""<br><b>"", `movie_trait_readable`, ""</b><br>"", "
"0","                          ""Number of movies: "", num_of_movies_1, ""<br>"","
"0","                          ""<b>"", proportion_hated_1_plot*100, ""%</b> are among the 100 most hated <i>Mixed</i> films <br>"","
"0","                          'Chi-sq p-value:', p_value"
"0","),"
"0","hovertemplate = ""%{hovertext}<extra></extra>"")"
"0",""
"0","fig2 <- fig2 %>% layout("
"0","               title = ""Top 100 "","
"0","               xaxis = list(title = ""Movie Trait?"", showticklabels = FALSE),"
"0","               yaxis = list(title = '<b> % of movies hated </b> \n Mixed' #,"
"0","                            # showgrid = FALSE"
"0","                            , range=c(0,30),"
"0","                            tickfont = list(color = '#b2b2b2')), "
"0","               barmode = 'group' #,"
"0","               # plot_bgcolor='#daebe8',"
"0","        #        margin=list("
"0","        # t=2, # top margin: 30px, you want to leave around 30 pixels to"
"0","        #       # display the modebar above the graph."
"0","        #  b=2 #, # bottom margin: 10px"
"0","        # # l=2, # left margin: 10px"
"0","        # # r=2"
"0","        # )"
"0","               # , legend = list(x =- 0.5, y = 1.2, orientation = ""h"")"
"0","        )"
"0",""
"0","fig3 <- plot_ly(data= most_hated_wider_df %>% filter(Metascore_Score_Meaning == metascore_groups[3]), x = ~movie_trait_readable, y = ~proportion_hated_0_plot*100, type = 'bar', name = 'No', marker = list(color = '#f7cac9'),"
"0","                 text = ~num_of_movies_0,"
"0","                textposition = ""none"","
"0","                hovertext = ~ paste0(""<br><b>Non-"", `movie_trait_readable`, ""</b><br>"", "
"0","                          ""Number of movies: "", num_of_movies_0, ""<br>"","
"0","                          ""<b>"", proportion_hated_0_plot*100, ""%</b> are among the 100 most hated <i>Unfavourable</i> films <br>"","
"0","                          'Chi-sq p-value:', p_value"
"0","),"
"0","hovertemplate = ""%{hovertext}<extra></extra>"")"
"0",""
"0","fig3 <- fig3 %>% add_trace(y = ~proportion_hated_1_plot*100, name = 'Yes', marker = list(color = '#bc5a45'),"
"0","                 text = ~num_of_movies_1,"
"0","                textposition = ""none"","
"0","                hovertext = ~ paste0(""<br><b>"", `movie_trait_readable`, ""</b><br>"", "
"0","                          ""Number of movies: "", num_of_movies_1, ""<br>"","
"0","                          ""<b>"", proportion_hated_1_plot*100, ""%</b> are among the 100 most hated <i>Unfavourable</i> films <br>"","
"0","                          'Chi-sq p-value:', p_value"
"0","),"
"0","hovertemplate = ""%{hovertext}<extra></extra>"")"
"0",""
"0","fig3 <- fig3 %>% layout("
"0","               title = ""<b> % of Movies Hated, by Movie Trait </b> - <i> \n grouped by Metacritics Reception</i> \n \n"","
"0","               xaxis = list(title = ""Movie Trait"", tickangle = 45),"
"0","               yaxis = list(title = ' \n Unfavourable' #,"
"0","                            # showgrid = FALSE"
"0","                            , range=c(0,30),"
"0","                            tickfont = list(color = '#b2b2b2')), "
"0","               barmode = 'group', "
"0","               # plot_bgcolor='#f0efef',"
"0","               margin=list("
"0","         # top margin: 30px, you want to leave around 30 pixels to"
"0","              # display the modebar above the graph."
"0","        # b=2 #, # bottom margin: 10px"
"0","        # l=2, # left margin: 10px"
"0","        # r=2"
"0","        )"
"0","        # , legend = list(x = 0.7, y = 1, orientation = ""v"")"
"0","               )"
"0",""
